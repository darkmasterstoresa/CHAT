<!DOCTYPE html>
<html lang="en">
<head>

 <!-- Lucide Icons CDN -->
<script src="https://unpkg.com/lucide@latest"></script>
 

  <!-- Font Awesome for Cloudflare-style icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

  <meta charset="UTF-8">
  <title>Beelze Chat Upgrade</title>
  <style>

  header {
      background: #111;
      color: #fff;
      padding: 20px;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    header h1 {
      margin: 0;
      font-size: 24px;
    }

    .profile-icon {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      background-size: cover;
      background-position: center;
      cursor: pointer;
      border: 2px solid white;
    }

    .profile-popup {
      position: fixed;
      top: 70px;
      right: 20px;
      background: white;
      border: 1px solid #ccc;
      padding: 20px;
      width: 300px;
      border-radius: 10px;
      box-shadow: 0 0 15px rgba(0,0,0,0.2);
      display: none;
      z-index: 999;
    }

    .profile-pic {
      width: 100px;
      height: 100px;
      border-radius: 50%;
      object-fit: cover;
      cursor: pointer;
      border: 2px solid #444;
    }

    .edit-icon {
      cursor: pointer;
      color: #111;
      margin-left: 8px;
    }

    .close-full {
      position: absolute;
      top: 10px;
      right: 20px;
      background: #000;
      color: white;
      font-size: 18px;
      padding: 5px 10px;
      border: none;
      border-radius: 100%;
      cursor: pointer;
    }

    #full-image-view {
      display: none;
      position: fixed;
      top: 0; left: 0;
      width: 100vw;
      height: 100vh;
      background: rgba(0,0,0,0.9);
      z-index: 1000;
      justify-content: center;
      align-items: center;
      flex-direction: column;
    }

    #full-image-view img {
      max-width: 90%;
      max-height: 80%;
      border-radius: 20px;
    }

    #login-box {
      padding: 20px;
      max-width: 300px;
      margin: 40px auto;
      background: white;
      border-radius: 10px;
      box-shadow: 0 0 10px rgba(0,0,0,0.2);
    }

    #login-box input {
      width: 100%;
      margin-bottom: 10px;
      padding: 10px;
      border: 1px solid #aaa;
      border-radius: 5px;
    }

    #login-box button {
      width: 100%;
      padding: 10px;
      background: #000;
      color: white;
      border: none;
      border-radius: 5px;
      cursor: pointer;
    }


#chatControls button {
  background: #f3f3f3;
  border: none;
  padding: 10px;
  border-radius: 8px;
  cursor: pointer;
}
#chatControls i {
  width: 24px;
  height: 24px;
  color: #000;
}


    body {
      font-family: Arial, sans-serif;
      background-color: #f2f2f2;
      margin: 0;
      padding: 0;
    }
    header {
      background-color: #111;
      color: white;
      padding: 10px 20px;
      text-align: center;
    }
    #chatContainer {
      display: flex;
      height: 90vh;
    }
    #userList {
      width: 25%;
      background: #fff;
      border-right: 1px solid #ccc;
      overflow-y: auto;
      padding: 10px;
    }
    #chatWindow {
      width: 75%;
      display: flex;
      flex-direction: column;
      justify-content: space-between;
      background: #eaeaea;
    }
    .user {
      padding: 10px;
      border-bottom: 1px solid #ccc;
      cursor: pointer;
    }
    .message {
      max-width: 60%;
      padding: 10px;
      margin: 10px;
      border-radius: 10px;
    }
    .myMessage {
      background-color: #007bff;
      color: white;
      margin-left: auto;
    }
    .otherMessage {
      background-color: #ddd;
      margin-right: auto;
    }
    #messageInput {
      display: flex;
      padding: 10px;
      background: white;
      border-top: 1px solid #ccc;
    }
    #messageInput input {
      flex: 1;
      padding: 10px;
      border: 1px solid #ccc;
      border-radius: 5px;
    }
    #messageInput button {
      margin-left: 10px;
      padding: 10px;
      border: none;
      cursor: pointer;
      background: #007bff;
      color: white;
      border-radius: 5px;
    }
    #adminPanel {
      display: none;
      padding: 10px;
      background-color: #eee;
    }
    #fileOptions {
      display: flex;
      gap: 10px;
      margin-top: 10px;
    }
    #fileOptions button {
      background: white;
      border: 1px solid #ccc;
      padding: 8px;
      border-radius: 5px;
      cursor: pointer;
    }
  </style>
</head>
<body>

<!-- LOGIN POPUP (show on start) -->
<div id="loginPopup" style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: #fff; z-index: 9999; display: flex; flex-direction: column; justify-content: center; align-items: center;">
  <h3 style="margin-bottom: 10px;">Welcome to Beelze Chat</h3>
  <input type="text" id="loginNumber" placeholder="Enter Phone Number" style="padding: 10px; width: 200px;">
  <div style="margin-top: 15px;">
    <button onclick="signIn()" style="padding: 8px 20px;">Sign In</button>
    <button onclick="signUp()" style="padding: 8px 20px;">Sign Up</button>
  </div>
</div>


<header>
  <h1>Beelze Chat</h1>
  <div class="profile-icon" id="profileIcon" style="background-image: url('default-profile.jpg');"></div>
</header>


<!-- PROFILE POPUP -->
<div id="profilePopup" style="display: none; position: absolute; top: 50px; right: 20px; background: #fff; border: 1px solid #000; padding: 15px; border-radius: 10px; z-index: 1000;">
  <img src="default-profile.jpg" id="profilePic" style="width: 80px; border-radius: 50%;" onclick="openFullImage()" />
  <br><br>
  <div>
    <strong>Name:</strong>
    <span id="profileName">Dark Master</span>
    <span onclick="editName()" style="cursor: pointer;">üñâ</span>
  </div>
  <br>
  <div>
    <strong>Bio:</strong>
    <div contenteditable="true" id="profileBio" style="border: 1px solid #ccc; padding: 5px; border-radius: 5px;">Hello, I am the king of this platform.</div>
  </div>
  <br>
  <input type="file" id="uploadPic" accept="image/*" onchange="changeProfilePic(event)">
  <br><br>
  <button onclick="logout()">Logout</button>
</div>



<!-- Profile Popup -->
<div class="profile-popup" id="profilePopup">
  <img src="default-profile.jpg" id="profilePic" class="profile-pic" onclick="openFullImage()" />
  <br><br>
  <div>
    <strong>Name:</strong>
    <span id="profileName">Dark Master</span>
    <span class="edit-icon" onclick="editName()">üñâ</span>
  </div>
  <br>
  <div>
    <strong>Bio:</strong>
    <div contenteditable="true" id="profileBio" style="border: 1px solid #ccc; padding: 5px; border-radius: 5px;">
      Hello, I am the king of this platform.
    </div>
  </div>
  <br>
  <input type="file" id="uploadPic" accept="image/*" onchange="changeProfilePic(event)">
</div>

<!-- Full Image Viewer -->
<div id="full-image-view" onclick="closeFullImage()">
  <button class="close-full">‚úñ</button>
  <img src="default-profile.jpg" id="fullProfilePic" />
</div>



  <div id="chatContainer">
    <div id="userList">
      <h3>Users</h3>
      <div id="users"></div>
      <button onclick="addUser()">‚ûï Add User</button>
    </div>


    <div id="chatWindow">
      <div id="messages" style="flex: 1; overflow-y: auto; padding: 10px;"></div>



      <div id="messageInput">
        <input type="text" id="messageBox" placeholder="Type your message...">
        <button onclick="sendMessage()">‚úâÔ∏è</button>
      </div>



    <div id="chatControls" style="display: flex; gap: 10px; align-items: center;">
  <button onclick="sendMessage()" title="Send Message">
    <i data-lucide="send"></i>
  </button>


  <button onclick="document.getElementById('videoInput').click()" title="Upload Video">
  <i data-lucide="video"></i>
</button>
<input type="file" id="videoInput" accept="video/*" style="display: none;" onchange="handleVideoUpload(event)">

  <button onclick="document.getElementById('imageInput').click()" title="Send Image">
    <i data-lucide="image"></i>
  </button>
  <input type="file" id="imageInput" accept="image/*" style="display: none;" onchange="sendImage(event)">

  <button onclick="document.getElementById('musicInput').click()" title="Send Song">
    <i data-lucide="music"></i>
  </button>
  <input type="file" id="musicInput" accept="audio/*" style="display: none;" onchange="sendMusic(event)">

  <button onclick="startRecording()" title="Record Audio">
    <i data-lucide="mic"></i>
  </button>
</div>


      <div id="adminPanel">
        <h3>Admin Panel</h3>
        <label>Name:</label>
        <input type="text" id="adminName" placeholder="Edit your profile name"><br>
        <label>Phone Number:</label>
        <input type="text" id="adminPhone" disabled><br>
        <button onclick="saveAdminProfile()">Save Profile</button>
      </div>
    </div>
  </div>

  <script>


  let isSignUp = false;

  function toggleMode() {
    isSignUp = !isSignUp;
    document.getElementById("authTitle").innerText = isSignUp ? "Sign Up" : "Sign In";
    document.getElementById("toggleText").innerText = isSignUp ? "Already have an account?" : "Don't have an account?";
  }

  function handleAuth() {
    const phone = document.getElementById("phoneInput").value;
    const pass = document.getElementById("passInput").value;
    const key = "user_" + phone;

    if (!phone || !pass) return alert("Fill all fields.");

    if (isSignUp) {
      if (localStorage.getItem(key)) return alert("User already exists.");
      const user = { password: pass, name: "", bio: "", image: "https://www.w3schools.com/howto/img_avatar.png" };
      localStorage.setItem(key, JSON.stringify(user));
      localStorage.setItem("currentUser", phone);
      loadProfile(phone);
    } else {
      const userData = localStorage.getItem(key);
      if (!userData) return alert("User not found.");
      const user = JSON.parse(userData);
      if (user.password !== pass) return alert("Wrong password.");
      localStorage.setItem("currentUser", phone);
      loadProfile(phone);
    }

    document.getElementById("authPopup").style.display = "none";
  }

  function loadProfile(phone) {
    const user = JSON.parse(localStorage.getItem("user_" + phone));
    document.getElementById("profileName").value = user.name || "";
    document.getElementById("profileBio").value = user.bio || "";
    document.getElementById("profilePic").src = user.image || "";
    document.getElementById("profileFullPic").src = user.image || "";
  }

  function toggleProfileView() {
    const popup = document.getElementById("profilePopup");
    popup.style.display = popup.style.display === "none" ? "block" : "none";
  }

  function saveProfile() {
    const phone = localStorage.getItem("currentUser");
    if (!phone) return;

    const key = "user_" + phone;
    const user = JSON.parse(localStorage.getItem(key));

    user.name = document.getElementById("profileName").value;
    user.bio = document.getElementById("profileBio").value;
    localStorage.setItem(key, JSON.stringify(user));
    alert("Saved!");
  }

  // üîÑ Auto login on reload
  window.onload = () => {
    const phone = localStorage.getItem("currentUser");
    if (phone && localStorage.getItem("user_" + phone)) {
      document.getElementById("authPopup").style.display = "none";
      loadProfile(phone);
    }
  };








  const profileIcon = document.getElementById('profileIcon');
  const profilePopup = document.getElementById('profilePopup');

  profileIcon.onclick = () => {
    profilePopup.style.display = profilePopup.style.display === 'block' ? 'none' : 'block';
  };

  function openFullImage() {
    const pic = document.getElementById('profilePic').src;
    document.getElementById('fullProfilePic').src = pic;
    document.getElementById('full-image-view').style.display = 'flex';
  }

  function closeFullImage() {
    document.getElementById('full-image-view').style.display = 'none';
  }

  function changeProfilePic(event) {
    const file = event.target.files[0];
    if (file) {
      const imgURL = URL.createObjectURL(file);
      document.getElementById('profilePic').src = imgURL;
      profileIcon.style.backgroundImage = `url('${imgURL}')`;
    }
  }

  function editName() {
    const newName = prompt("Enter new name:");
    if (newName) {
      document.getElementById('profileName').innerText = newName;
    }
  }

  function login() {
    const number = document.getElementById('phoneNumber').value;
    const pass = document.getElementById('password').value;
    alert("Login for user " + number + " successful (not connected to backend yet)");
  }







    const currentUser = { number: localStorage.getItem('userNumber'), name: localStorage.getItem('userName') || 'You' };

    function displayUsers() {
      const usersDiv = document.getElementById('users');
      usersDiv.innerHTML = '';
      const users = JSON.parse(localStorage.getItem('allUsers')) || [];
      users.forEach(u => {
        const div = document.createElement('div');
        div.className = 'user';
        div.textContent = `${u.name} (${u.number})`;
        usersDiv.appendChild(div);
      });
    }

    function addUser() {
      const number = prompt('Enter number for new user:');
      const name = prompt('Enter name:');
      const users = JSON.parse(localStorage.getItem('allUsers')) || [];
      users.push({ number, name });
      localStorage.setItem('allUsers', JSON.stringify(users));
      displayUsers();
    }

    function sendMessage() {
      const text = document.getElementById('messageBox').value;
      if (!text) return;
      addMessage(text, 'myMessage');
      document.getElementById('messageBox').value = '';
    }

    function addMessage(content, className) {
      const msgDiv = document.createElement('div');
      msgDiv.className = `message ${className}`;
      msgDiv.textContent = content;
      document.getElementById('messages').appendChild(msgDiv);
    }

    function uploadFile(type) {
      const fileInput = document.getElementById('fileInput');
      fileInput.accept = type;
      fileInput.click();
    }

    function handleFileUpload(event) {
      const file = event.target.files[0];
      if (file) addMessage(`üìé ${file.name}`, 'myMessage');
    }

    function startVoiceRecording() {
      alert('Voice recording feature not implemented yet.');
    }

    function saveAdminProfile() {
      const name = document.getElementById('adminName').value;
      localStorage.setItem('userName', name);
      displayUsers();
    }

    function checkAdmin() {
      if (currentUser.number === 'admin') {
        document.getElementById('adminPanel').style.display = 'block';
        document.getElementById('adminPhone').value = currentUser.number;
        document.getElementById('adminName').value = currentUser.name;
      }
    }

    window.onload = () => {
      if (!currentUser.number) {
        const number = prompt('Enter your number:');
        localStorage.setItem('userNumber', number);
        localStorage.setItem('userName', number);
        currentUser.number = number;
        currentUser.name = number;
      }
      checkAdmin();
      displayUsers();
    }


  lucide.createIcons();










 
 







 
  // Auto-show login popup when the page loads if no user saved
  window.onload = function () {
    const savedUser = localStorage.getItem("userPhone");
    if (!savedUser) {
      document.getElementById("loginPopup").style.display = "flex";
    }
  };

  function signIn() {
    const number = document.getElementById("loginNumber").value;
    if (number.length < 5) {
      alert("Enter a valid number");
      return;
    }
    localStorage.setItem("userPhone", number);
    showProfile(number);
  }

  function signUp() {
    const number = document.getElementById("loginNumber").value;
    if (number.length < 5) {
      alert("Enter a valid number to sign up");
      return;
    }
    localStorage.setItem("userPhone", number);
    showProfile(number);
  }

  function logout() {
    localStorage.removeItem("userPhone");
    location.reload(); // Restart page to show login again
  }

  function showProfile(number) {
    document.getElementById("loginPopup").style.display = "none";
    document.getElementById("profilePopup").style.display = "block";
    document.getElementById("profileName").innerText = number;
  }

  function editName() {
    const newName = prompt("Enter your new name:");
    if (newName) {
      document.getElementById("profileName").innerText = newName;
    }
  }

  function changeProfilePic(event) {
    const file = event.target.files[0];
    const reader = new FileReader();
    reader.onload = function (e) {
      document.getElementById("profilePic").src = e.target.result;
    };
    if (file) {
      reader.readAsDataURL(file);
    }
  }

 

  </script>
</body>
</html>